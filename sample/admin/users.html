<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Management - South Cotabato Data Bank</title>
  <link rel="stylesheet" href="../assets/css/variables.css">
  <link rel="stylesheet" href="../assets/css/base.css">
  <link rel="stylesheet" href="../assets/css/components.css">
  <link rel="stylesheet" href="../assets/css/utilities.css">
  <link rel="stylesheet" href="../assets/css/admin.css">
</head>
<body>
  <div class="admin-layout">
    <aside class="admin-sidebar">
      <div class="admin-sidebar-header"><a href="index.html" class="admin-logo"><i data-lucide="database"></i><span>SC Data Bank</span></a></div>
      <nav class="admin-nav">
        <div class="admin-nav-section">
          <div class="admin-nav-title">Main</div>
          <a href="index.html" class="admin-nav-link"><i data-lucide="layout-dashboard"></i><span>Dashboard</span></a>
        </div>
        <div class="admin-nav-section">
          <div class="admin-nav-title">Data Management</div>
          <a href="sitio-list.html" class="admin-nav-link"><i data-lucide="map-pin"></i><span>Sitios</span></a>
          <a href="project-list.html" class="admin-nav-link"><i data-lucide="folder"></i><span>Projects</span></a>
          <a href="import.html" class="admin-nav-link"><i data-lucide="upload-cloud"></i><span>Import Data</span></a>
        </div>
        <div class="admin-nav-section">
          <div class="admin-nav-title">System</div>
          <a href="users.html" class="admin-nav-link active"><i data-lucide="users"></i><span>Users</span></a>
          <a href="../public/index.html" class="admin-nav-link"><i data-lucide="external-link"></i><span>View Public Portal</span></a>
        </div>
      </nav>
      <div class="admin-sidebar-footer">
        <div class="admin-user-info"><div class="admin-user-avatar">A</div><div class="admin-user-details"><div class="admin-user-name">Admin User</div></div></div>
      </div>
    </aside>
    <main class="admin-main">
      <header class="admin-header">
        <div class="admin-header-content">
          <h1 class="admin-page-title">User Management</h1>
          <button class="btn btn-primary btn-sm" onclick="showModal('addUserModal')"><i data-lucide="plus"></i><span>Add User</span></button>
        </div>
      </header>
      <div class="admin-content">
        <div class="card">
          <div class="card-header"><h3 class="card-title">All Users (<span id="userCount">0</span>)</h3></div>
          <div class="card-content" style="padding: 0;">
            <div class="table-container" style="border: none; border-radius: 0;">
              <table class="table">
                <thead><tr><th>Name</th><th>Email</th><th>Role</th><th>Department</th><th>Status</th><th>Actions</th></tr></thead>
                <tbody id="usersTable"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="../assets/js/icons.js"></script>
  <script src="../assets/js/main.js"></script>
  <script src="../assets/js/mock-data.js"></script>
  <script>
    if (!localStorage.getItem('isLoggedIn')) window.location.href = 'login.html';
    document.addEventListener('DOMContentLoaded', loadUsers);

    function loadUsers() {
      const users = window.mockData.users;
      document.getElementById('usersTable').innerHTML = users.map(user => `
        <tr>
          <td><div style="font-weight: 500;">${user.name}</div></td>
          <td>${user.email}</td>
          <td><span class="badge badge-primary">${user.role}</span></td>
          <td>${user.department}</td>
          <td><span class="badge badge-success">Active</span></td>
          <td>
            <div class="table-actions">
              <button class="btn btn-ghost btn-sm" title="Edit"><i data-lucide="edit"></i></button>
              <button class="btn btn-ghost btn-sm" onclick="deleteUser(${user.id})" title="Delete"><i data-lucide="trash-2"></i></button>
            </div>
          </td>
        </tr>
      `).join('');
      document.getElementById('userCount').textContent = users.length;
      refreshIcons();
    }

    function deleteUser(id) {
      if (confirm('Are you sure?')) {
        showToast('User deleted', 'success');
        loadUsers();
      }
    }
  </script>
</body>
</html>
